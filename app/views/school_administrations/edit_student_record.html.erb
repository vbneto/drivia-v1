<%= back_button %>
<div class="container">
  <div id="subject_list">
    <div class = "panel panel-default student_record_form">
      <div class = "panel-heading">
        <h5><%= t("school_administration.edit_student_record.Edit_student") %></h5>
      </div>
      <div class = "panel-body" id ="edits_students">
        <%= form_for @student_record, url: update_student_school_administrations_path(:id => @student_record), method: :post, :validate => true do|f|%>
          <% if @student_record.errors.any? %>
             <div id="error_explanation" class="alert alert-block alert-error">
             <a class="close" data-dismiss="alert" href="#">X</a>
              <h4 class = "alert-heading"><%= pluralize(@student_record.errors.count, "error") %>Something went wrong!</h4>
              <ul>
                <% @student_record.errors.full_messages.each do |msg| %>
                  <li><%= msg %></li>
                <% end %>
              </ul>
            </div>  
          <% end %>
          <table>
            <tr>
              <td><%= f.label :student_name %></td>
              <td><%= f.label "First Parent Name" %></td>
              <td><%= f.label "Second Parent Name" %></td>
            </tr>
            <tr>
              <td><%= f.text_field :student_name, :class => "input-medium" %></td>
              <td><%= f.text_field :parent_name_1, :class => "input-medium" %></td>
              <td><%= f.text_field :parent_name_2, :class => "input-medium" %></td>
            </tr>
          <div>
            <%= f.fields_for :student_statuses do |builder| %>
              <tr>
                <td><%= builder.label :current_grade %></td>
                <td><%= builder.label :grade_class %></td>
              </tr>
              <tr>
                <td><%= builder.select :current_grade, options_for_select(uniq_school_grade_name, @student_record.get_active_status.current_grade)%></td>

                <td><%= builder.select :grade_class, options_for_select(uniq_school_grade_class, @student_record.get_active_status.grade_class)%></td>
                <%= builder.hidden_field :year, :value=>Date.today.year %>
              </tr>
            <% end %>
          </div>
          <div>
          <%= f.fields_for :user do |builder| %>
            <tr>
              <td>
              <%= builder.label :phone %>
              </td>
              <td><%= builder.label :phoneprefix %></td>
            </tr>
            <tr>
              <td><%= builder.text_field :phone, :class => "input-medium" %>
              </td>
              <div id="phone_error">
              </div>
              <div id="phoneprefix_error">
              </div>
              <td><%= builder.text_field :phoneprefix, :class => "input-medium" %></td>
            </tr>
            <%= builder.hidden_field :name %>
           </div>
          <%end%>
          </table>
            <%= f.submit "update", :class=>'btn', onclick:"return validate_form()"%>
        <%end%>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $('#student_from_excel_birth_day').datepicker({
    format: "dd/mm/yyyy",
    viewMode: "years",
    startView: 2
  });
  
  function validate_form()
  { var valid = true;
    if($("#student_from_excel_user_attributes_phone").val().length != 9)
    { 
      $("#phone_error").text("Phone must have size of 9").fadeIn(1000);
      valid =false;
    }
    else if($("#student_from_excel_user_attributes_phoneprefix").val().length != 2)
    { 
      $("#phoneprefix_error").text("Phoneprefix must have size of 2 ").fadeIn(1000);
      valid =false;
    }
     
    return valid;
  }
  
</script>
